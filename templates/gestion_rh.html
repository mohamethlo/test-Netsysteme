{% extends "base.html" %}

{% block content %}
<div class="container-fluid py-4">
    <div class="row">
        <!-- Sidebar -->
        <nav class="col-md-2 d-none d-md-block sidebar vh-100 position-fixed" style="background-color: #0b173d;">
            <div class="sidebar-sticky pt-3">
                <div class="px-3 py-3 mb-4 text-white fw-bold fs-5 d-flex align-items-center">
                    <i data-feather="users" class="me-2"></i> Gestion RH
                </div>

                <ul class="nav flex-column mt-2">
                    {% if current_user.has_permission('attendance') %}
                    <li class="nav-item">
                        <a class="nav-link active text-white" id="tab-attendance-btn" href="#" onclick="showTab('attendance')">
                            <i data-feather="clock" class="text-white"></i> Pointage
                        </a>
                    </li>
                    {% endif %}

                    {% if current_user.has_permission('salary_advances') %}
                    <li class="nav-item">
                        <a class="nav-link text-white" id="tab-advances-btn" href="#" onclick="showTab('advances')">
                            <i data-feather="dollar-sign" class="text-white"></i> Avances
                        </a>
                    </li>
                    {% endif %}

                    {% if current_user.has_permission('work_locations') or current_user.has_permission('all') %}
                    <li class="nav-item">
                        <a class="nav-link text-white" id="tab-work-locations-btn" href="#" onclick="showTab('work_locations')">
                            <i data-feather="map-pin" class="text-white"></i> Zones de travail
                        </a>
                    </li>
                    {% endif %}
                </ul>
            </div>
        </nav>

        <!-- Main content -->
        <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4 offset-md-2 vh-100 d-flex flex-column">
            
            <!-- Onglet Pointage -->
            <div id="attendance" class="tab-content flex-grow-1">
                <iframe src="{{ url_for('main.attendance') }}" frameborder="0" style="width:100%; height:100%;"></iframe>
            </div>

            <!-- Onglet Avances -->
            <div id="advances" class="tab-content d-none flex-grow-1">
                <iframe src="{{ url_for('main.salary_advances') }}" frameborder="0" style="width:100%; height:100%;"></iframe>
            </div>

            <!-- Onglet Zones de travail -->
            <div id="work_locations" class="tab-content d-none flex-grow-1">
                <iframe src="{{ url_for('main.work_locations') }}" frameborder="0" style="width:100%; height:100%;"></iframe>
            </div>

        </main>

    </div>
</div>

<script>
function showTab(tabId) {
    // Masquer tous les onglets
    document.querySelectorAll('.tab-content').forEach(tab => tab.classList.add('d-none'));
    // Afficher l'onglet sélectionné
    document.getElementById(tabId).classList.remove('d-none');

    // Mettre à jour l'état actif de la sidebar
    document.querySelectorAll('.nav-link').forEach(link => link.classList.remove('active'));
    document.getElementById('tab-' + tabId + '-btn').classList.add('active');
}
</script>

<style>
.nav-link.active {
    background-color: #06204d;
    font-weight: bold;
    border-radius: 0.25rem;
}
.nav-link:hover {
    background-color: #06204d;
    border-radius: 0.25rem;
    color: #fff !important;
}
</style>

<style>
html, body {
    height: 100%;
    margin: 0;
}

.sidebar {
    height: 100vh;
}

.tab-content iframe {
    display: block;
    border: none;
}
</style>

{% endblock %}
